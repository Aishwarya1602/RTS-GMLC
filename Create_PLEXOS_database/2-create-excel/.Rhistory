install.packages('openxlsx')
library(rplexos)
plexos_open('//plexossql/data/moconnel/CA Flexibility Paper/Mark_runs')
s
files = plexos_open('//plexossql/data/moconnel/CA Flexibility Paper/Mark_runs')
View(files)
View(files)
db = files[1]
View(db)
db = files[,1]
View(db)
db = files[1,]
View(db)
database = db
gsub('.*Model ', '', database[1,3])
plexos_open(c('//plexossql/data/moconnel/CA Flexibility Paper/Mark_runs/1','//plexossql/data/moconnel/CA Flexibility Paper/Mark_runs/2'))
files = plexos_open(c('//plexossql/data/moconnel/CA Flexibility Paper/Mark_runs/1','//plexossql/data/moconnel/CA Flexibility Paper/Mark_runs/2'))
View(files)
query_year(files, 'Generator', 'Generation')
sum_year(files, 'Generator', 'Generation')
results = query_year(files, 'Region', 'Load')
View(results)
library(dplyr)
library(data.table)
library(reshape2)
library(plyr)
# Load all files
mapping = fread('//plexossql/data/moconnel/Gen_CSV_Mapping_Files/GenNamesTEPPC_2024_RPV_dispatch.CSV')
max.cap.monthly.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_monthly_fromWECCdb.csv')
max.cap.static.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_fromWECCdb.csv')
min.stable.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_minStable_fromWECCdb.csv')
max.energy.monthly.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/hydro_MaxEnergyMonth_fromWECCdb.csv')
gen_jennie = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_minStable_WECC_jennie.csv')
View(gen_jennie)
View(max.cap.monthly.plexos)
max.cap.monthly.plexos = merge(max.cap.monthly.plexos, mapping, by='name')
max.cap.static.plexos = merge(max.cap.static.plexos, mapping, by='name')
min.stable.plexos = merge(min.stable.plexos, mapping, by='name')
max.energy.monthly.plexos = merge(max.energy.monthly.plexos, mapping, by='name')
View(max.cap.monthly.plexos)
unique(max.cap.monthly.plexos$Type)
unique(max.cap.static.plexos$Type)
unique(max.energy.monthly.plexos$Type)
str(max.cap.monthly.plexos)
max.cap.monthly.plexos <- max.cap.monthly.plexos[Type=='Hydro',]
View(max.cap.monthly.plexos)
unique(max.cap.monthly.plexos$Type)
max.cap.monthly.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_monthly_fromWECCdb.csv')
max.cap.monthly.plexos = merge(max.cap.monthly.plexos, mapping, by='name')
max.cap.monthly.plexos
unique(max.cap.monthly.plexos$Type)
View(max.cap.monthly.plexos)
max.cap.monthly.plexos <- max.cap.monthly.plexos[Type=='Hydro',]
max.cap.static.plexos <- max.cap.monthly.plexos[Type=='Hydro',]
min.stable.plexos <- min.stable.plexos[Type=='Hydro',]
max.energy.monthly.plexos <- max.energy.monthly.plexos[Type=='Hydro',]
gen_jennie <- gen_jennie[Type=='Hydro',]
View(max.cap.static.plexos)
View(max.cap.monthly.plexos)
View(max.cap.static.plexos)
max.cap.static.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_fromWECCdb.csv')
max.cap.static.plexos = merge(max.cap.static.plexos, mapping, by='name')
max.cap.static.plexos <- max.cap.monthly.plexos[Type=='Hydro',]
View(max.cap.static.plexos)
max.cap.static.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_fromWECCdb.csv')
View(max.cap.static.plexos)
max.cap.static.plexos = merge(max.cap.static.plexos, mapping, by='name')
View(max.cap.static.plexos)
max.cap.static.plexos <- max.cap.static.plexos[Type=='Hydro',]
View(max.cap.static.plexos)
length(unique(max.cap.static.plexos$name))
length(unique(max.cap.monthly.plexos$name))
test[1] = (unique(max.cap.static.plexos$name)
)
test = data.table(monthly = unique(max.cap.monthly.plexos$name), static = unique(max.cap.static.plexos))
View(test)
rm(test)
test = data.table(monthly = unique(max.cap.monthly.plexos$name), static = unique(max.cap.static.plexos))
View(test)
test <- data.table(monthly = unique(max.cap.monthly.plexos$name), static = unique(max.cap.static.plexos))
test1 = unique(max.cap.monthly.plexos$name)
test2 = unique(max.cap.static.plexos$name)
test3 = data.table(test1, test2)
View(test3)
test3[,diff := test1==test2]
View(test3)
sum(test3$diff)
nrow(test43)
nrow(test3)
rm(test, test3, test1, test2)
View(max.cap.monthly.plexos)
View(max.cap.static.plexos)
unique(max.cap.static.plexos$Scenario)
View(max.cap.monthly.plexos)
max.cap.monthly.plexos = dcast(max.cap.monthly.plexos, name+TypeSpecific~Month, value.var='Max Capacity')
View(max.cap.monthly.plexos)
View(min.stable.plexos)
unique(min.stable.plexos$scenario)
min.stable.plexos <- min.stable.plexos[scenario=='Monthly Min Stable Level']
min.stable.plexos = dcast(min.stable.plexos, name~timeslice, value.var='value')
View(max.energy.monthly.plexos)
unique(max.energy.monthly.plexos$scenario)
max.energy.monthly.plexos <- max.energy.monthly.plexos[scenario=='update from V1.1 to V1.2' | scenario=='']
View(max.energy.monthly.plexos)
max.energy.dates = max.energy.monthly.plexos[date.from!=""]
max.energy.dates = max.energy.dates[grepl(2024, max.energy.dates[,date.from])]
max.energy.base = max.energy.monthly.plexos[date.from==""]
max.energy <- rbind(max.energy.base, max.energy.dates)
max.energy <- data.table(dcast(max.energy, name+timeslice~scenario, value.var='value'))
View(max.energy)
max.energy[, value := `update from V1.1 to V1.2`]
max.energy[is.na(value), value := Var.3]
View(max.energy)
max.energy = dcast(max.energy, name~timeslice, value.var='value')
View(max.energy)
library(dplyr)
library(data.table)
library(reshape2)
library(plyr)
# Load all files
mapping = fread('//plexossql/data/moconnel/Gen_CSV_Mapping_Files/GenNamesTEPPC_2024_RPV_dispatch.CSV')
max.cap.monthly.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_monthly_fromWECCdb.csv')
# max.cap.static.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_fromWECCdb.csv')
min.stable.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_minStable_fromWECCdb.csv')
max.energy.monthly.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/hydro_MaxEnergyMonth_fromWECCdb.csv')
gen_jennie = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_minStable_WECC_jennie.csv')
# Add gen type to files
max.cap.monthly.plexos = merge(max.cap.monthly.plexos, mapping, by='name')
# max.cap.static.plexos = merge(max.cap.static.plexos, mapping, by='name')
min.stable.plexos = merge(min.stable.plexos, mapping, by='name')
max.energy.monthly.plexos = merge(max.energy.monthly.plexos, mapping, by='name')
# Remove all non-hydro generators
max.cap.monthly.plexos <- max.cap.monthly.plexos[Type=='Hydro',]
# max.cap.static.plexos <- max.cap.static.plexos[Type=='Hydro',]
min.stable.plexos <- min.stable.plexos[Type=='Hydro',]
max.energy.monthly.plexos <- max.energy.monthly.plexos[Type=='Hydro',]
gen_jennie <- gen_jennie[Type=='Hydro',]
max.energy.monthly.plexos <- max.energy.monthly.plexos[scenario=='update from V1.1 to V1.2' | scenario=='']
max.energy.dates = max.energy.monthly.plexos[date.from!=""]
max.energy.dates = max.energy.dates[grepl(2024, max.energy.dates[,date.from])]
max.energy.base = max.energy.monthly.plexos[date.from==""]
max.energy <- rbind(max.energy.base, max.energy.dates)
max.energy <- data.table(dcast(max.energy, name+timeslice~scenario, value.var='value'))
max.energy[, value := `update from V1.1 to V1.2`]
max.energy[is.na(value), value := Var.3]
max.energy.monthly.plexos = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/hydro_MaxEnergyMonth_fromWECCdb.csv')
min.stable.plexos <- min.stable.plexos[scenario=='Monthly Min Stable Level']
min.stable.plexos = dcast(min.stable.plexos, name~timeslice, value.var='value')
# write.csv(min.stable, '//nrelqnap01d/plexos/projects/im3/Thermal_Hydro_Gen_Params/monthlyMinStable_hydro.csv', row.names=FALSE)
# Extract monthly maximum energy for hydro units from database, and then write csv file
max.energy.monthly.plexos <- max.energy.monthly.plexos[scenario=='update from V1.1 to V1.2' | scenario=='']
max.energy.dates = max.energy.monthly.plexos[date.from!=""]
max.energy.dates = max.energy.dates[grepl(2024, max.energy.dates[,date.from])]
max.energy.base = max.energy.monthly.plexos[date.from==""]
max.energy <- rbind(max.energy.base, max.energy.dates)
max.energy <- data.table(dcast(max.energy, name+timeslice~scenario, value.var='value'))
max.energy[, value := `update from V1.1 to V1.2`]
max.energy[is.na(value), value := Var.3]
# max.energy[is.na(value), value := `MonthlyEnergy with K equal to zero`]
max.energy = dcast(max.energy, name~timeslice, value.var='value')
View(max.energy)
View(gen_jennie)
gen_maxCap = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_WECC_plexos_output.csv')
View(gen_maxCap)
gen_maxCap = merge(gen_maxCap, mapping, by='name')
gen_maxCap = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_WECC_plexos_output.csv')
gen_maxCap = merge(gen_maxCap, mapping, by='name')
View(gen_maxCap)
gen_maxCap[Type %in% c('CHP-QF', 'Gas CT', 'Biomass', 'Gas CC', 'Coal', 'Steam', 'Nuclear')]
gen_maxCap <- gen_maxCap[Type %in% c('CHP-QF', 'Gas CT', 'Biomass', 'Gas CC', 'Coal', 'Steam', 'Nuclear')]
gen_maxCap_db = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_fromWECCdb.csv')
gen_maxCap_db = merge(gen_maxCap_db, mapping, by='name')
max.cap.thermal = gen_maxCap_db[Type %in% c('CHP-QF', 'Gas CT', 'Biomass', 'Gas CC', 'Coal', 'Steam', 'Nuclear')]
max.cap.thermal.noscen = max.cap.thermal[Scenario == '']
max.cap.thermal.lcgs = max.cap.thermal[Scenario == 'CA_GasFleet_LCGS']
for ( i in max.cap.thermal.lcgs[,name] ) {
max.cap.thermal.noscen[name==i, `Max Capacity` := max.cap.thermal.lcgs[name==i, `Max Capacity`]]
}
therm.db = max.cap.thermal.noscen
View(max.cap.thermal.noscen)
View(gen_maxCap)
mapping = fread('//plexossql/data/moconnel/Gen_CSV_Mapping_Files/GenNamesTEPPC_2024_RPV_dispatch.CSV')
gen_maxCap_db = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_fromWECCdb.csv')
gen_maxCap_db = merge(gen_maxCap_db, mapping, by='name')
max.cap.thermal = gen_maxCap_db[Type %in% c('CHP-QF', 'Gas CT', 'Biomass', 'Gas CC', 'Coal', 'Steam', 'Nuclear')]
max.cap.thermal.noscen = max.cap.thermal[Scenario == '']
max.cap.thermal.lcgs = max.cap.thermal[Scenario == 'CA_GasFleet_LCGS']
for ( i in max.cap.thermal.lcgs[,name] ) {
max.cap.thermal.noscen[name==i, `Max Capacity` := max.cap.thermal.lcgs[name==i, `Max Capacity`]]
}
therm.db = max.cap.thermal.noscen
gen_maxCap = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_WECC_plexos_output.csv')
gen_maxCap = merge(gen_maxCap, mapping, by='name')
gen_maxCap <- gen_maxCap[Type %in% c('CHP-QF', 'Gas CT', 'Biomass', 'Gas CC', 'Coal', 'Steam', 'Nuclear')]
write.csv(gen_maxCap, '//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/plexos_mapCap.csv', row.names=FALSE)
write.csv(therm.db, '//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/prevoius_mapCap.csv', row.names=FALSE)
gen_maxCap_db = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_fromWECCdb.csv')
gen_maxCap_db = merge(gen_maxCap_db, mapping, by='name')
max.cap.thermal = gen_maxCap_db[Type %in% c('CHP-QF', 'Gas CT', 'Biomass', 'Gas CC', 'Coal', 'Steam', 'Nuclear')]
max.cap.thermal.noscen = max.cap.thermal[Scenario == '']
max.cap.thermal.lcgs = max.cap.thermal[Scenario == 'CA_GasFleet_LCGS']
for ( i in max.cap.thermal.lcgs[,name] ) {
max.cap.thermal.noscen[name==i, `Max Capacity` := max.cap.thermal.lcgs[name==i, `Max Capacity`]]
}
View(max.cap.thermal.noscen)
gen_maxCap = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_WECC_plexos_output.csv')
gen_maxCap = merge(gen_maxCap, mapping, by='name')
gen_maxCap <- gen_maxCap[Type %in% c('CHP-QF', 'Gas CT', 'Biomass', 'Gas CC', 'Coal', 'Steam', 'Nuclear')]
write.csv(gen_maxCap, '//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/plexos_maxCap.csv', row.names=FALSE)
write.csv(therm.db, '//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/prevoius_maxCap.csv', row.names=FALSE)
gen_maxCap = fread('//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/all_maxCap_static_WECC_plexos_output.csv')
gen_maxCap = merge(gen_maxCap, mapping, by='name')
gen_maxCap <- gen_maxCap[Type == 'Hydro']
View(gen_maxCap)
write.csv(gen_maxCap, '//nrelqnap01d/plexos/projects/im3/WECC_db_gen_data/plexos_maxCap_hydro.csv', row.names=FALSE)
library(rplexos)
process_folder('//nrelqnap01d/plexos/projects/im3/PLEXOS database/Model DA_Nodal_Baseline_IM3_1day_regionLoad Solution/')
process_folder('//nrelqnap01d/plexos/projects/im3/PLEXOS database/Model DA_Nodal_Baseline_IM3_1day_regionLoad Solution')
db = plexos_open('//nrelqnap01d/plexos/projects/im3/PLEXOS database/Model DA_Nodal_Baseline_IM3_1day_regionLoad Solution')
prop = query_property(db)
View(prop)
?query_log_steps
library(rplexos)
?query_log_steps
source('C:/Users/moconnel/Documents/RTS-GMLC/Create_PLEXOS_database/1-parse-matpower/parse_matpower.R', echo=TRUE)
source('C:/Users/moconnel/Documents/RTS-GMLC/Create_PLEXOS_database/2-create-excel/run_PSSE2PLEXOS.R', echo=TRUE)
